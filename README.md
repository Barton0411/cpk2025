# 牧场数据CPK分析系统

## 访问密码
默认密码：cpk2025
（可在 config.py 文件中修改）

## 功能介绍
本系统用于分析牧场牛奶质量数据，计算各项性状的统计指标和CPK值。

### 主要功能
1. **数据分析** - 计算6个性状的统计指标：
   - σ（标准差）
   - X（平均值）
   - 过程值差值
   - 6σ
   - 3σ
   - cpk
   - 公差
   - cp

2. **数据筛选** - 支持多维度筛选：
   - 区域筛选
   - 地区筛选
   - 时间段筛选
   - 奶源地筛选

3. **CPK异常检测** - 自动识别CPK异常数据

## 安装和运行

### 安装依赖
```bash
pip3 install -r requirements.txt
```

### 运行应用
```bash
./run.sh
```

或直接运行：
```bash
streamlit run app.py
```

## 使用说明

1. **启动应用** - 运行后会自动在浏览器打开应用界面

2. **配置参数** - 在左侧边栏配置：
   - 季节时间段
   - 过程值差值系数
   - 酸度参数
   - 公差设置

3. **上传数据** - 选择Excel数据文件或使用默认数据文件

4. **数据筛选** - 根据需要选择区域、地区、时间段、奶源地

5. **计算分析** - 点击"计算分析指标"查看结果

6. **CPK异常筛选** - 设置CPK范围后点击"筛选CPK异常"

## 数据格式要求
Excel文件需包含以下列：
- 大区、区域、地区
- 奶源地名称
- 入库日期
- 脂肪、蛋白、干物质、酸度、微生物（菌落总数）、体细胞

## 公式说明

### 基本计算
- **过程值差值**（脂肪、蛋白、干物质、菌落总数、体细胞）= |平均值 - 过程值差值系数|
- **过程值差值**（酸度）= min(平均值 - 酸度最小值, 酸度最大值 - 平均值)
- **6σ** = σ × 6
- **3σ** = σ × 3
- **cpk** = 过程值差值 / 3σ
- **cp** = 公差 / 6σ

### 季节系数
- **夏季**（默认5月-9月）：脂肪3.2、蛋白2.9、干物质11.8
- **冬季**（默认10月-4月）：脂肪3.4、蛋白3.0、干物质11.9